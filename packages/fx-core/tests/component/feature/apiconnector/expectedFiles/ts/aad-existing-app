// This file is auto generated by Teams Toolkit to provide you instructions and reference code to call your API.

/*
Next steps:
1. Run npm install. We added the @microsoft/teamsfx to your package.json.
   You need to run the command under the "bot" folder (instead of your project root folder).
2. Replace "<your-api-scope>" in this file with actual scope required by the API.
3. Set `TEAMSFX_API_FAKE_CLIENT_SECRET` to your client secret in the file `bot/.env.teamsfx.local`.

It is also recommended to put all the configurations into config.ts file.

You can import the API client (an Axios instance) in another file and call fake APIs and authentication is now handled for you automatically.

Here is an example for a GET request to "relative_path_of_target_api":
```
import { fakeClient } from "relative_path_to_this_file";

const response = await fakeClient.get("relative_path_of_target_api");
// You only need to enter the relative path for your API.
// For example, if you want to call api https://my-api-endpoint/test and you configured https://my-api-endpoint as the API endpoint,
// your code will be: const response = await fakeClient.get("test");

const responseBody = response.data;
```

If you added this API while local debugging, stop local debugging and start again because local debugging will not hot reload changes to `.env.teamsfx.local`.

Refer to https://aka.ms/teamsfx-connect-api to learn more. 
*/
import {
  TeamsFx,
  createApiClient,
  BearerTokenAuthProvider,
  IdentityType,
} from "@microsoft/teamsfx";

// Load application configuration. This sample uses the client credential flow to acquire a token for your API.
const teamsFx = new TeamsFx(IdentityType.App, {
  // You can replace the default authorityHost URL
  authorityHost: "https://login.microsoftonline.com",
  tenantId: process.env.TEAMSFX_API_FAKE_TENANT_ID!,
  clientId: process.env.TEAMSFX_API_FAKE_CLIENT_ID!,
  // This references the client secret that you must add in the file `.env.teamsfx.local`.
  clientSecret: process.env.TEAMSFX_API_FAKE_CLIENT_SECRET!,
});
// Initialize a new axios instance to call fake
const appCredential = teamsFx.getCredential();
const authProvider = new BearerTokenAuthProvider(
  // TODO: Replace '<your-api-scope>' with your required API scope
  async () => (await appCredential.getToken("<your-api-scope>"))!.token
);
const fakeClient = createApiClient(
  process.env.TEAMSFX_API_FAKE_ENDPOINT,
  authProvider
);
export { fakeClient };

/* 
Setting API configuration for cloud environment: 
We have set configuration in `.env.teamsfx.local` based on your answers. 
Before you deploy your code to Azure using TeamsFx, follow https://aka.ms/teamsfx-add-appsettings to add the following configuration (with their appropriate values) to your Azure environment: 
TEAMSFX_API_FAKE_ENDPOINT
TEAMSFX_API_FAKE_TENANT_ID
TEAMSFX_API_FAKE_CLIENT_ID
TEAMSFX_API_FAKE_CLIENT_SECRET

Refer to https://aka.ms/teamsfx-connect-api to learn more. 
*/